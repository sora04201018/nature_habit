<div class="max-w-lg mt-5 mb-5 mx-auto bg-white rounded-xl shadow p-5">
  <h1 class=" text-green-700 text-2xl font-bold mb-4">🌿 投稿の編集 🌿</h1>

  <%= form_with model: @post, method: :put, local: true do |f| %>
    <div class="mb-3">
      <%= f.label :title, "タイトル", class: "block font-semibold" %>
      <%= f.text_field :title, class: "w-full border rounded p-2" %>
    </div>

    <div class="mb-3">
      <%= f.label :body, "感想", class: "block font-semibold" %>
      <%= f.text_area :body, class: "w-full border rounded p-2", rows: 5 %>
    </div>

    <div class="mb-3" data-controller="image-preview">
      <%= f.label :image, "画像", class: "block font-semibold" %>

      <% if @post.image.attached? %>
        <p class="text-sm text-gray-600 mb-1">現在の画像</p>
        <%= image_tag @post.image,
              id: "post-image-preview",
              class: "w-24 h-24 object-cover rounded mb-2" %>
      <% else %>
        <%= image_tag "",
              id: "post-image-preview",
              class: "w-24 h-24 object-cover rounded mb-2 hidden" %>
      <% end %>

      <%= f.file_field :image,
            accept: "image/*",
            data: { action: "change->image-preview#preview" } %>

      <p class="text-xs text-gray-500 mt-1">
        ※ 新しい画像を選択すると、上のプレビューが切り替わります
      </p>
    </div>

    <%= f.submit "更新する", class: "w-full bg-green-500 text-white py-2 rounded hover:bg-green-700" %>

    <%= link_to "詳細に戻る", post_path, class: "w-full block text-center mt-3 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400" %>
  <% end %>
</div>
